# ì…ì‹¤ ì²´í¬ í•´ì£¼ì„¸ìš” !! ğŸ’Œ
# build.gradle ìˆ˜ì • í›„ ìµœì‹  version ë¶€í„° ì ìš©í•˜ê² ìŠµë‹ˆë‹¤.

3. ìê²© ì¦ëª…ì„ ì €ì¥í•˜ëŠ” ìƒˆ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í• ê²ë‹ˆë‹¤. Record ê°œë…ì„ ì‚¬ìš©í•  ì˜ˆì •. domain íŒ¨í‚¤ì§€ ë‚´ì— AccountCredentials ë ˆì½”ë“œë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.

  - Record ë°ì´í„°ë§Œ ë³´ê´€í•˜ëŠ” í´ë˜ìŠ¤ê°€ í•„ìš”í•  ë•Œ ë§ì€ ìƒìš©êµ¬ ì½”ë“œë¥¼ í”¼í•  ìˆ˜ ìˆëŠ” ë°©ì‹ìœ¼ë¡œ,
```java
package com.example.cardatabase.domain;

public record AccountCredentials(String username, String password) {}
```
  - ì´ìƒê³¼ ê°™ì´ ì‘ì„±í–ˆì„ ê²½ìš° username / passwordì— ëŒ€í•œ Getter / Setterë¥¼ ì•ˆì¨ë„ ë©ë‹ˆë‹¤.

# Java Record
- RecordëŠ” ë°ì´í„° ìš´ë°˜ì²´(Data Carrier) ì—­í• ì„ í•˜ëŠ”  í´ë˜ìŠ¤ë¥¼ ê°„ê²°í•˜ê²Œ ìƒì„±í•˜ê¸° ìœ„í•´ 14ì—ì„œ ë„ì…ë˜ì—ˆê³ , 16ì—ì„œ ì •ì‹ ê¸°ëŠ¥ì´ ëìŠµë‹ˆë‹¤. ì£¼ë¡œ DTO(Data Transfer Object)ë‚˜ POJO(Plain Old Java Object)ì™€ ê°™ì€ ë¶ˆë³€ ë°ì´í„° ê°ì²´ë¥¼ ë§Œë“¤ ë•Œ ë°œìƒí•˜ëŠ” ë°˜ë³µì ì¸ ìƒìš©êµ¬ ì½”ë“œ(boilerplate code) ì‘ì„±ì„ ì¤„ì´ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ ë°œëª…ë¨.

## Record íŠ¹ì§•
1. ê°„ê²°ì„±
  - fieldë§Œì„ ì •ì˜í•˜ë©´, ì»´íŒŒì¼ëŸ¬ê°€ í•„ìš”í•œ ë©”ì„œë“œë“¤ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
  - ì´ìƒì˜ ê²½ìš°ëŠ” usernameê³¼ passwordì— ëŒ€í•œ getter / setterë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•œë‹¤ê³  í–ˆìŠµë‹ˆë‹¤.
2. ë¶ˆë³€ì„±
  - ëª¨ë“  fieldëŠ” private finalë¡œ ì„ ì–¸ë©ë‹ˆë‹¤. -> privateì´ë‹ˆê¹Œ getter/setterë¡œ ê²½ìœ í•˜ì—¬ ê°’ì„ ë„£ì–´ì•¼ê² ë„¤ìš”.
3. ìë™ìƒì„±
  - ì´í•˜ì˜ ë©¤ë²„ë“¤ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.
      1. AllArgsConstructor - () ë‚´ì— ì •ì˜ëœ ëª¨ë“  fieldë“¤ì„ ì‚¬ìš©í•˜ëŠ” ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.
      2. ì ‘ê·¼ì ë©”ì„œë“œ(Accessor Methods) : ì „í†µì ìœ¼ë¡œ íŠ¹ì • fieldì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì ‘ë‘ì‚¬ì¸ `get`ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  fieldëª…ì„ ê·¸ëŒ€ë¡œ ì”ë‹ˆë‹¤. person.getName()ê³¼ ê°™ì´ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ person.name
4. ì œì•½ì‚¬í•­
  - ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì„ ìˆ˜ ì—†ìŒ.
  - ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ fieldë¥¼ ì„ ì–¸í•  ìˆ˜ ì—†ìœ¼ë©°, ë ˆì½”ë“œ headerì— ì •ì˜ëœ fieldë“¤ ì™¸ì˜ fieldëŠ” staticì´ì–´ì•¼ë§Œ í•¨.
```java
public record Person(String name, int age) {
  // getter / setterëŠ” ì•Œì•„ì„œ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì— Lombok ë„ì… ë“±ì´ ë¶ˆí•„ìš”
  // ê°ì²´ ìƒì„± ì‹œì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìœ„í•˜ì—¬ ìƒì„±ìë¥¼ ì»¤ìŠ¤í…€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  public Person {
    if (age < 0) {
      throw new IllegalArgumentException("ë¶ˆê°€ëŠ¥í•œ ë‚˜ì´ ì…ë ¥ì…ë‹ˆë‹¤.");
    }
  }
}

public class PersonMain {
  public static void main(String[] args) {
    // Recordë¥¼ í†µí•œ ê°ì²´ ìƒì„± ë° ì‚¬ìš© ë°©ë²• ì˜ˆì‹œë“¤ì„ ì‘ì„±í•©ë‹ˆë‹¤.
    Person person1 = new Person("ê¹€ì¼", 21);  // AllArgsConstructorê°€ ê¸°ë³¸ìƒì„±ì´ê¸° ë•Œë¬¸ì— ì–˜ë¡œë§Œ ê°ì²´ ìƒì„± ê°€ëŠ¥
    String name = person1.name();
    System.out.printlin(name + " í•™ìƒì€ " + person1.age() + " ì‚´ì…ë‹ˆë‹¤.");
    System.out.printlin(person1.toString());    // ì›ë˜ toString()ì€ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•Šê³  ê°ì²´ëª…ë§Œìœ¼ë¡œ ë½‘ì•„ë‚¼ ìˆ˜ ìˆì—ˆì§€ë§Œ ë­ ì´ëŸ°ì‹ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. Person[name=ê¹€ì¼, age=21]
  }
}
```
# Java Optional
`java.util.Optional<T>` í´ë˜ìŠ¤ëŠ” Java 8ì—ì„œ ë„ì…ë˜ì—ˆê³ , _ê°’ì´ ìˆì„ ìˆ˜ë„ ìˆê³ , ì—†ì„ ìˆ˜ë„ ìˆëŠ”(present or absent)_ ì»¨í…Œì´ë„ˆ ê°ì²´. ì£¼ìš” ëª©ì ì€ null ê°’ì„ ì§ì ‘ ì²˜ë¦¬í•˜ì§€ ëª»í•˜ë„ë¡ í•˜ì—¬, í”„ë¡œê·¸ë˜ë¨¸ì˜ ì‹¤ìˆ˜ë¥¼ ì¤„ì´ê³  í”íˆ ë°œìƒí•˜ëŠ” `NullPonterException` ì˜ˆì™¸ë¥¼ ë°©ì§€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

## Optional íŠ¹ì§•
1. NPE ë°©ì§€
  - ë©”ì„œë“œì˜ return ê°’ì´ nullì´ ë  ê°€ëŠ¥ì„±ì´ ìˆì„ ë•Œ(findByUsername(username)ì˜ ê²°ê³¼ê°’ì´ nullì¼ ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼), Optionalì„ ë„ì…í•˜ë©´ í˜¸ì¶œìëŠ” ëª…ì‹œì ìœ¼ë¡œ ê°’ì´ ì—†ì„ ë•Œì˜ ìƒí™©ì„ ì²˜ë¦¬í•˜ë„ë¡ ê°•ì œë©ë‹ˆë‹¤(ë¹¼ë¨¹ê³  ì§€ë‚˜ê°ˆ ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ ì˜¤ë¥˜ ë°œìƒ ì•ˆí•˜ê² ì£ ).
2. í•¨ìˆ˜í˜• ìŠ¤íƒ€ì¼
  - map(), filter(), ifPresent() ë“±ì˜ ë©”ì„œë“œë¥¼ ì œê³µí•˜ê³  í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
3. ì˜ë„ ë…¸ì¶œ
  - Optionalì„ ë„ì…í•œë‹¤ëŠ” ê²ƒë§Œìœ¼ë¡œë„ íŠ¹ì • ë©”ì„œë“œì˜ returnê°’ì´ nullì´ ë  ìˆ˜ ìˆìŒì„ ë‹¤ë¥¸ ê°œë°œìë“¤ì´ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Optional ê°ì²´ ìƒì„± ë° ì‚¬ìš© ë°©ë²•
1. Optional.of(T value)
  - nullì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ Optionalì„ ìƒì„±. ë§Œì•½ ì´ ë©”ì„œë“œì˜ í˜¸ì¶œë¡œ valueì— null ë„£ìœ¼ë©´ NullPointerException ë°œìƒí•¨.
2. Optional.ofNullable(T value)
  - valueê°€ nullì¼ ìˆ˜ë„ ìˆëŠ” ê°’ìœ¼ë¡œ Optional ìƒì„±. nullì´ë©´ Optional.empty()ë¥¼ return
3. Optional.empty()
  - ê°’ì´ ì—†ëŠ” ë¹„ì–´ìˆëŠ” Optional ê°ì²´ë¥¼ return.

### ë°ì´í„° ì²˜ë¦¬ ë©”ì„œë“œ(NPE ë°©ì§€ ë° ëŒ€ì²´)
1. isPresent()
  - ê°’ì´ ì¡´ì¬í•˜ë©´ true ë°˜í™˜
2. get()
  - ê°’ì„ ë°˜í™˜. ê°’ì´ ì—†ìœ¼ë©´ NoSuchElementExceptionì„ ë°œìƒì‹œí‚¤ë¯€ë¡œ, isPresent()ë¡œ í™•ì¸ í›„ ì‚¬ìš©í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
  - ì €í¬ ìˆ˜ì—… ìƒí™©ì—ì„œì˜ ì˜ˆì‹œ
```java
@Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        Optional<AppUser> user = userRepository.findByUsername(username);

        UserBuilder builder = null;
        if (user.isPresent()) { // ì´í•˜ì˜ ì‹¤í–‰ë¬¸ì´ ì‹¤í–‰ëœë‹¤ë©´ userì— AppUser ê°ì²´ê°€ ìˆë‹¤ëŠ” ì˜ë¯¸   // ì´ ë¶€ë¶„ì—ì„œ Optionalì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
            AppUser currentUser = user.get();                                                     // ì—¬ê¸°ì„œë„ ì¼ì£ . ê°ê° 1, 2 ë²ˆ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•¨.
            builder = User.withUsername(username);
            builder.password(currentUser.getPassword());
            builder.roles(currentUser.getRole());
        } else {
            throw new UsernameNotFoundException("User not found.");
        }

        return builder.build();
```
3. orElse(T other)
  - ê°’ì´ ì¡´ì¬í•˜ë©´ ê·¸ ê°’ì„ ë°˜í™˜í•˜ê³ , ê°’ì´ ì—†ìœ¼ë©´ `other`ë¡œ ì „ë‹¬ëœ ê¸°ë³¸ ê°’ì„ return
4. orElseGet(Supplier<? extends T> other)
  - ê°’ì´ ì¡´ì¬í•˜ë©´ ê·¸ ê°’ì„ ë°˜í™˜í•˜ê³ , ê°’ì´ ì—†ìœ¼ë©´ `other`(ëŒë‹¤ì‹)ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜(orElseì™€ ë‹¬ë¦¬ ê°’ì´ ì—†ëŠ” ê²½ìš°ì—ë§Œ ëŒë‹¤ì‹ì´ í˜¸ì¶œë¨).
5. ifPresent(Consumer<? super T> action)
  - ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ `action`(ëŒë‹¤ì‹)ì„ ì‹¤í–‰

## Optional ì‚¬ìš© ì˜ˆì‹œ
```java
public class Example1 {
  public static void main(String[] args) {
    Optional<String> maybeName = Optional.ofNullable(findByUsername(username)); // ê°’ì´ nullì¼ ìˆ˜ë„ ìˆìŒ

    // 1. ê°’ì´ ìˆì„ ë•Œë§Œ ì‘ì—… ìˆ˜í–‰í•˜ëŠ” .ifPresent() - ëŒë‹¤ì‹ ì ìš©
    maybeName.ifPresent(name -> System.out.println("ì‚¬ìš©ì ì´ë¦„ : " + name));

    // 2. ê°’ì´ ì—†ì„ ë•Œ ê¸°ë³¸ ê°’ ì œê³µ
    String name = maybeName.orElse("Guest");    // ê°’ì´ ì—†ìœ¼ë©´ "Guest"ë¥¼ return
    System.out.printlin("ì‚¬ìš©ì ì´ë¦„ : " + name); // ì‚¬ìš©ì ì´ë¦„ : Guest ê°€ ê²°ê³¼ê°’ì´ê² ë„¤ìš”.

    // 3. ê°’ì´ ì—†ì„ ë•Œì˜ ì˜ˆì™¸ ë°œìƒ
    String requriedName = maybeName.orElseThrow();  // ê°’ì´ ì—†ìœ¼ë©´ NoSuchElementException ë°œìƒ
  }
}
```

# ë¡œê·¸ì¸ì„ ìœ„í•œ AccountCredentialsë¥¼ Recordë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤ ì´í›„ ê³¼ì •.
1. ë¡œê·¸ì¸ì„ ìœ„í•œ controller í´ë˜ìŠ¤ ìƒì„± í• ê²ë‹ˆë‹¤. `/login` ì—”ë“œí¬ì¸íŠ¸ë¥¼ POST ë©”ì„œë“œë¡œ í˜¸ì¶œí•˜ê³  ì‚¬ìš©ì ì´ë¦„ê³¼ ì•”í˜¸ë¥¼ ìš”ì²­ ë³¸ë¬¸ê³¼ í•¨ê»˜ ì „ì†¡í•˜ì—¬ ë¡œê·¸ì¸í• ê²ë‹ˆë‹¤(ê·¸ëŸ¬ë‹ˆê¹Œ Spring Securityì˜ defaultë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ë˜ê² ë„¤ìš”).
  - web íŒ¨í‚¤ì§€ ë‚´ì— LoginController í´ë˜ìŠ¤ ìƒì„±.
  - ë¡œê·¸ì¸ ì„±ê³µ ì‹œì— JWTë¥¼ ìƒì„±í•˜ëŠ” ë° ì´ìš©ë  JwtService ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ì— ì‚½ì…í•´ì•¼ í•©ë‹ˆë‹¤. ì´í•˜ëŠ” ê·¸ ê³¼ì •ì„ í’€ì–´ë‚¸ ì½”ë“œì…ë‹ˆë‹¤.
```java
package com.example.cardatabase.web;

import com.example.cardatabase.domain.AccountCredentials;
import com.example.cardatabase.service.JwtService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class LoginController {
    // field ì„ ì–¸ -> final í‚¤ì›Œë“œ
    private final JwtService jwtService;
    private final AuthenticationManager authenticationManager;

    // ê·¸ë ‡ê¸° ë•Œë¬¸ì— í•„ìˆ˜ì ìœ¼ë¡œ AllArgsContructorë¡œ ìƒì„±í•´ì•¼ë§Œ í•˜ê³ 
    public LoginController(JwtService jwtService, AuthenticationManager authenticationManager) {
        this.jwtService = jwtService;
        this.authenticationManager = authenticationManager;
    }

    // POST ìš”ì²­ì„ ìœ„í•œ methodë¥¼ ì‘ì„± ì¤‘ì¸ë°
    // ì €í¬ê°€ fieldë¡œ ë°›ì•„ì˜¨ ë¶€ë¶„ì„ ì‚¬ìš©í•˜ì—¬ method í˜¸ì¶œì„ ì´ LoginControllerì˜ getToken()ë©”ì„œë“œ ë‚´ì—ì„œ í•˜ê² ì£ .
    @PostMapping("/login")
    public ResponseEntity<?> getToken(@RequestBody AccountCredentials credentials) {
        // ì—¬ê¸°ì— í† í° ìƒì„±í•˜ê³  ì‘ë‹µì˜ Authorization í—¤ë”ë¡œ ì „ì†¡í•´ì£¼ëŠ” ë¡œì§ ì‘ì„±í• ê²ë‹ˆë‹¤.
    }
}
```

1. ResponseEntity í´ë˜ìŠ¤
- ì •ì˜
  - ResponseEntity<T>ëŠ” Springì—ì„œ HTTP ì‘ë‹µ ì „ì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ë¡œ ê·¸ë˜ì„œ Controller í´ë˜ìŠ¤ì—ì„œ ì“°ì…ë‹ˆë‹¤. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì—ì„œ ì´ í´ë˜ìŠ¤ë¥¼ returní•˜ë©´, ê°œë°œìê°€ ì‘ë‹µì˜ ë°ì´í„°(Body), HTTP ìƒíƒœ ì½”ë“œ(Status Code), ê·¸ë¦¬ê³  _HTTP header_ ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì œì–´í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  - RESTful API ì„¤ê³„ì—ì„œ ì„œë²„ì˜ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì •í™•í•˜ê²Œ ì „ë‹¬í•˜ëŠ” ë° í•„ìˆ˜ì .

- ì£¼ìš” íŠ¹ì§• ë° êµ¬ì„± ìš”ì†Œ
  1. Body(ë³¸ë¬¸)
    - í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‹¤ì œë¡œ ì „ì†¡ë˜ëŠ” ë°ì´í„°. ì œë„¤ë¦­ `<>`ìœ¼ë¡œ ì§€ì •ë¨.
    - `User` ê°ì²´, `List<Product>` ë“±(JSON í˜•íƒœë¡œ ë³€í™˜ë˜ì–´ ì „ì†¡ë¨(postmanì—ì„œ JSON ê¸°ì¤€ì´ì—ˆì£ .))
  2. Status Code(ìƒíƒœ ì½”ë“œ)
    - ìš”ì²­ ì²˜ë¦¬ ê²°ê³¼ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” 3 ìë¦¬ ìˆ«ì
    - HttpStatus.OK - (200)
    - HttpStatus.CREATED - (201)
    - HttpStatus.NOT_FOUND - (404)
  3. Headers(í—¤ë”)
    - ì‘ë‹µì— ëŒ€í•œ ì¶”ê°€ì ì¸ ë©”íƒ€ ë°ì´í„°
    - HttpHeaders.CONTENT_TYPE
    - HttpHeaders.AUTHORIZATION
    - HttpHeaders.LOCATION
## `ReponseEntity<T>` ì˜ˆì‹œ
```java
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

// 1. ì„±ê³µ ì‘ë‹µ (200 OK)
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
  User user = userService.findById(id);

  // ìƒíƒœ ì½”ë“œ 200 OKì™€ User ê°ì²´ë¥¼ ì‘ë‹µ ë³¸ë¬¸ì— ë‹´ì•„ì„œ ë°˜í™˜
  return new ResponseEntity<>(user, HttpStatus.OK);
}

// 2. ìƒì„± ì„±ê³µ ì‘ë‹µ (201 Created)
// .created() ë¹Œë”ë¥¼ í™œìš©í•˜ì—¬ Location í—¤ë”ë¥¼ ìë™ ì¶”ê°€ ê°€ëŠ¥
@PostMapping("/products")
public ResponseEntity<Void> createProduct(@RequestBody Product newProduct) {
  Product savedProduct = productService.save(newProduct);

  // ìƒíƒœ ì½”ë“œ 201 Createdì™€ í•¨ê»˜ Location í—¤ë”ë¥¼ ë°˜í™˜(BodyëŠ” ì—†ìŠµë‹ˆë‹¤-POST ìš”ì²­í•  ë•Œ Bodyë¥¼ ì¼ëŠ”ë°ìš” ë¼ëŠ” ì§ˆë¬¸ì„ í•˜ê²Œ ëœë‹¤ë©´ ìš°ë¦¬ê°€ GETìš”ì²­í•  ë•ŒëŠ” Body ì‘ì„± ì•ˆí–ˆëŠ”ë° ê²°ê³¼ê°’ì—ëŠ” JSONì´ ìˆì—ˆì–ì•„ìš” ë¼ê³  ëŒ€ë‹µí•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.)
  return ResponseEntity.created(URI.create("/products/" + savedProduct.getId())).build();
}

// 3. ì‹¤íŒ¨ ì‘ë‹µ (404 Not Found)
@GetMapping("/items/{id}")
public ResponseEntity<String> getItem(@PathVariable Long id) {
  if (itemService.findItem(id) == null) {
    //ìƒíƒœ ì½”ë“œ 404 Not Foundì™€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ResponseEntityì˜ bodyì— ë‹´ì•„ì„œ return
    return ResponseEntity.status(HttpStatus.NOT_FOUND).body("í•´ë‹¹ itemì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
  }
  // ì—¬ê¸° ë¶€ë¶„ì€ ì•„ì´í…œì„ ì°¾ì•˜ì„ ë•Œì˜ ë¡œì§ì„ ì‘ì„±í•˜ë©´ ë˜ê² ì£ .
  // ê¸°íƒ€ ë¡œì§ ì“°ê³  ë§¨ ë§ˆì§€ë§‰ì—
  return ReponseEntity.status(HttpStatus.OK)
}
```
# POST ìš”ì²­ ì‹œì— í•„ìš”í•œ @RequestBody ì• ë„ˆí…Œì´ì…˜
- ì •ì˜
HTTP ìš”ì²­ ë©”ì„œë“œ(POST, PUT, PATCH ë“±)ì˜ ìš”ì²­ ë³¸ë¬¸(body)ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ ì½ì–´ì™€ Spring Controller ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì—°ê²°(bining)í•  ë•Œ ì‚¬ìš©. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

- íŠ¹ì§• ë° ì‘ë™ ì›ë¦¬
1. ìë™ ì—­ì§ë ¬í™” : `@RequestBody`ì˜ í•µì‹¬ ê¸°ëŠ¥ìœ¼ë¡œ, ìš”ì²­ ë³¸ë¬¸ì— í¬í•¨ëœ JSON, XML ë“±ì˜ ë°ì´í„°ë¥¼ ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ë¡œ ì§€ì •ëœ Java ê°ì²´ë¡œ ìë™ ë³€í™˜í•´ì¤ë‹ˆë‹¤.
2. ë©”ì‹œì§€ ì»¨ë²„í„°(Message Converter) : Springì˜ `HttpMessageConverter`ê°€ ë‹´ë‹¹í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ, ì˜ˆë¥¼ ë“¤ì–´ JSON ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ê²Œ ë˜ë©´ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»¨ë²„í„°ê°€ ì´ë¥¼ Java ê°ì²´ë¡œ ë³€í™˜í•´ì¤ë‹ˆë‹¤.
3. ë°ì´í„° ë°”ì¸ë”© : ìš”ì²­ bodyì˜ field ì´ë¦„ê³¼ ëŒ€ìƒ Java ê°ì²´ì˜ field ì´ë¦„ì´ ì¼ì¹˜í•˜ë©´ ìë™ìœ¼ë¡œ ê°’ì´ ì£¼ì…ë©ë‹ˆë‹¤.
## @RequestBody ì‚¬ìš© ì˜ˆì‹œ
```java
@Getter
@Setter
public class Product {
  private String name;
  private int price;
}

// ì–´ì©Œê³  ì»¨íŠ¸ë¡¤ëŸ¬
@PostMapping("/products")
// í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ ë³¸ë¬¸ì˜ JSON ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ Product ê°ì²´ì¸ productë¡œ ë³€í™˜
public ResponseEntity<String> addProduct(@RequestBody Product product) {
  // product ê°ì²´ëŠ” ì´ë¯¸ JSONì˜ "name" í‚¤ì™€ "price"í‚¤ë¥¼ ë‹´ê³  ìˆëŠ” ìƒí™©

  if (product.getPrice() <= 0) {
    return ResponseEntity.badRequest().body("ê°€ê²©ì€ ì–‘ìˆ˜ì—¬ì•¼ë§Œ í•©ë‹ˆë‹¤."); // 400 BAD_REQUEST
  }

  productService.save(product)
  return ReponseEntity.status(HttpStatus.CREATED).body("ìƒí’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
}
```
- ì°¸ê³  ì‚¬í•­ : `@RequestBody`ëŠ” ìš”ì²­ ë³¸ë¬¸(body)ì´ ì—†ëŠ” GET ìš”ì²­ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë©° ë³´í†µì€ _`POST`, `PUT`_ ê³¼ ê°™ì´ ë°ì´í„° ì „ì†¡ì´ í•„ìš”í•œ ìš”ì²­ì— ì‚¬ìš©ë©ë‹ˆë‹¤.


LoginControllerì˜ getToken ë©”ì„œë“œ ë¡œì§ ë¶€ë¶„
```java
    @PostMapping("/login")
    public ResponseEntity<?> getToken(@RequestBody AccountCredentials credentials) {
        UsernamePasswordAuthenticationToken creds =
                new UsernamePasswordAuthenticationToken(credentials.username(), credentials.password());
        // credentials.username() ì´ê±° ì €í¬ê°€ Recordë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— getUsername()ì´ ì•„ë‹Œ ê²ƒì— ì£¼ëª©í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

        Authentication auth = authenticationManager.authenticate(creds);

        // í† í° ìƒì„± - jwtsë¥¼ ì§€ì—­ë³€ìˆ˜ë¡œ ë³´ì…”ë„ ë¬´ë°©í•˜ì£ .
        String jwts = jwtService.getToken(auth.getName());

        // ìƒì„±ëœ í† í°ìœ¼ë¡œ ì‘ë‹µì„ ë¹Œë“œ
        return ResponseEntity
                .ok()
                .header(HttpHeaders.AUTHORIZATION, "Bearer " + jwts)
                .header(HttpHeaders.ACCESS_CONTROL_EXPOSE_HEADERS, "Authorization")
                .build();
    }
```
ì´ìƒê¹Œì§€ ì‘ì„±í–ˆì„ ë•Œ LoginControllerì˜ fieldë¡œ AuthenticationManagerë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— SecurityConfigì— ì„¤ì •ì´ ì¶”ê°€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì•„ì§ ì‹¤í–‰ì´ ì•ˆë©ë‹ˆë‹¤...

```java
// SecurityConfig.java
    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration authConfig) throws Exception {
        return authConfig.getAuthenticationManager();
    }
```
ì´ìƒì„ ê¸°ì¤€ìœ¼ë¡œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹° Config ê´€ë ¨ì„ ì†ëŒ€ì•¼ í•©ë‹ˆë‹¤. Spring securityì˜ SecurityFilterChain beanì€ ì–´ë–¤ ê²½ë¡œ(ì—”ë“œí¬ì¸íŠ¸)ê°€ ë³´í˜¸ë˜ê³ , ì–´ë–¤ ê²½ë¡œê°€ ë³´í˜¸ë˜ì§€ ì•ŠëŠ”ì§€ ì •ì˜í•©ë‹ˆë‹¤. filterChain() ë©”ì„œë“œë¥¼ ì¶”ê°€í• ê±´ë°, ê¸°ë³¸ì ì¸ ì •ì˜ëŠ” /login ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•œ POST ìš”ì²­ì€ ì¸ì¦ì´ ì—†ì–´ë„ í—ˆìš©ë˜ë„ë¡ ì‘ì„±í• ê²ë‹ˆë‹¤. ë‹¤ë¥¸ ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•œ ìš”ì²­ì€ ì¸ì¦ì´ í•„ìš”í•˜ë„ë¡ ì •ì˜í•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤. ë˜í•œ Spring Securityê°€ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡°(csrf)ë¥¼ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆë„ë¡ ì •ì˜í• ê²ë‹ˆë‹¤. JWTëŠ” ìƒíƒœ ë¹„ì €ì¥í˜•(RESTful ì›¹ ì„œë¹„ìŠ¤ì˜ íŠ¹ì§•ì´ì£ )ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ ì„¸ì…˜ ê´€ë ¨ ì·¨ì•½ì„±ì˜ ìœ„í—˜ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤. HTTP ë³´ì•ˆ êµ¬ì„±ì—ì„œ ì˜¤ëœë§Œì— Lambda Expressionì„ ì‚¬ìš©í• ê²ë‹ˆë‹¤.

ë¡œê·¸ì¸ ì‹¤íŒ¨í•˜ì‹  ë¶„ë“¤ ì¤‘ ë‹¤ìˆ˜ê°€
postman ìƒì—ì„œ New Requestë¥¼ ìƒˆë¡œ ìƒì„±í•˜ì§€ ì•Šê³  ì–´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ PATCH ìš”ì²­ í•  ë•Œ ì¼ë˜
Content-Type text/list ì„¤ì •ìœ¼ë¡œ í•´ë‘” ìƒíƒœì˜€ê¸° ë•Œë¬¸ì— 403 Fobbidenìœ¼ë¡œ ë–´ìŠµë‹ˆë‹¤.
Content-Type application/jsonìœ¼ë¡œ í•´ë‘ì‹œë©´ ì„±ê³µí•©ë‹ˆë‹¤.

# @PathVariable ì• ë„ˆí…Œì´ì…˜
- ì •ì˜ ë° ëª©ì 
  í•´ë‹¹ ì• ë„ˆí…Œì´ì…˜ì€ Spring Webì—ì„œ URLì˜ _ê²½ë¡œ ë³€ìˆ˜(Path Variable)_ ì— ìˆëŠ” ê°’ì„ ì¶”ì¶œí•˜ì—¬ Controllerì˜ ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ë°”ì¸ë”© í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŠ” íŠ¹ì • ë¦¬ì†ŒìŠ¤ë¥¼ ì‹ë³„í•˜ê±°ë‚˜ _ì¡°íšŒ_ í•  ë•Œ RESTful API ë””ìì¸ì„ êµ¬í˜„í•˜ëŠ” ë° í•µì‹¬ì ì¸ ì—­í• ì„ í•©ë‹ˆë‹¤.

- íŠ¹ì§• ë° ì‘ë™ ì›ë¦¬
1. URL ê²½ë¡œ ë§¤í•‘ : URL ê²½ë¡œì˜ íŠ¹ì • ë¶€ë¶„ì„ ë³€ìˆ˜ì²˜ëŸ¼ `{id}`ì™€ ê°™ì´ í‘œì‹œí•˜ê³ , ê·¸ ë³€ìˆ˜ì— í• ë‹¹ëœ ì‹¤ì œ ê°’ì„ ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
2. RESTful ì‹ë³„ì : ì£¼ë¡œ ê°œë³„ ë¦¬ì†ŒìŠ¤(íŠ¹ì • ì‚¬ìš©ì ID / íŠ¹ì • ìƒí’ˆ ë²ˆí˜¸ ë“±)ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ë©° URI(Uniform Resource Identifier)ì˜ ì˜ë¯¸ë¥¼ ëª…í™•í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.
3. ìë™ íƒ€ì… ë³€í™˜ : ê²½ë¡œì—ì„œ ì¶”ì¶œëœ ë¬¸ìì—´ì€ ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ì˜ íƒ€ì…(`Long, Integer, String` ë“±)ì—  ë§ê²Œ ìë™ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
## ì˜ˆì‹œ
```java
public class User {
  private Long id;
  private String name;
  //...
}

@RestController
@RequestMapping("/api/users")
public class UserController {
  // 1. ë‹¨ì¼ ê²½ë¡œ ë³€ìˆ˜ ì‚¬ìš© ì˜ˆì‹œ
  // URI : /api/users/123
  @GetMapping("/{userId}")
  //  {userId} ê²½ë¡œì˜ ê°’ 123ì„ Long ìë£Œí˜•ì˜ userId ë³€ìˆ˜ì— ë°”ì¸ë”©(ëŒ€ì…)
  public ResponseEntity<User> getUserById(@PathVariable("userId") Long id) {
    // PathVariableë¡œ ë°›ì€ userIdë¥¼ ì´ìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ìë¥¼ ì¡°íšŒ
    User user = userService.findById(id);

    if (user == null) {
      return ResponseEntity.notFound().build();
    }
    return ResponseEntity.ok(user); // 200 OKì™€ user ë°ì´í„°ë¥¼ ì‘ë‹µ.
  }

  // 2. ì—¬ëŸ¬ PathVariable ì‚¬ìš© ì˜ˆì‹œ
  @GetMapping("/{userId}/orders/{orderId}")
  public ResponseEntity<Order> getUserOrder(
    @PathVariable Long userId, @PathVariable Long orderId
  ) {     // ë³€ìˆ˜ ì´ë¦„ì´ ê°™ìœ¼ë©´ ("userId") / ("orderId")ê°€ ìƒëµ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    Order order = orderService.findByUserIdAndOrderId(userId, orderId);

    // orderê°€ ì—†ìœ¼ë©´ ë­ ì–´ì©Œê³  not found ë¡œì§ ìˆëŠ”ë° ì‹ ê²½ ì•ˆì“°ê² ìŠµë‹ˆë‹¤.

    return ResponseEntity.ok(order);
  }
}
```

# ë‹¤ë¥¸ ìš”ì²­ ë³´í˜¸í•˜ê¸°
ë°¥ ë¨¹ê¸° ì „ì— êµ³ì´ Loginí•˜ì§€ ì•Šê³ ë„ ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ì—”ë“œí¬ì¸íŠ¸ì¸ POST /login ë¶€ë¶„ì„ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ì´ì œ ë‚˜ë¨¸ì§€ ìˆ˜ì‹  ìš”ì²­ì— ëŒ€í•œ ì¸ì¦ ì²˜ë¦¬ë¥¼ ë‹¤ë£° í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ í”„ë¡œì„¸ìŠ¤ì—ì„œëŠ” ìš”ì²­ì´ Controllerì— ì „ë‹¬ë˜ê¸° ì „ì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µì´ ì „ì†¡ë˜ê¸° ì „ì— ì¼ë¶€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” filterë¥¼ ì´ìš©í•©ë‹ˆë‹¤.

1. í•„í„° í´ë˜ë¥¼ ì´ìš©, ë‹¤ë¥¸ ëª¨ë“  ìˆ˜ì‹  ìš”ì²­ì„ ì¸ì¦ ì²˜ë¦¬í• ê²ë‹ˆë‹¤. com.example.cardatabaseì— AuthenticationFilter í´ë˜ìŠ¤ë¥¼ ìƒì„±. í•´ë‹¹ í´ë˜ìŠ¤ëŠ” Spring Securityì˜ OncePerRequestFilter ì¸í„°í˜ì´ìŠ¤ë¥¼ _í™•ì¥_ í•˜ì—¬ ì¸ì¦ì„ _êµ¬í˜„_ í•  ìˆ˜ ìˆëŠ” doFilterInternal ë©”ì„œë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤. requestì—ì„œ í† í°ì„ í™•ì¸í•˜ê¸° ìœ„í•´ í•„í„° í´ë˜ìŠ¤ì— JwtService ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì£¼ì…í•©ë‹ˆë‹¤. SecurityContextHolderëŠ” Spring Securityê°€ ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì„¸ë¶€ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ë¶€ë¶„ì— í•´ë‹¹í•©ë‹ˆë‹¤. ì´í•˜ì˜ ì½”ë“œì—ì„œ ê²€ì¦í•©ë‹ˆë‹¤.
```java
package com.example.cardatabase;

import com.example.cardatabase.service.JwtService;
import jakarta.servlet.FilterChain;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpHeaders;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.filter.OncePerRequestFilter;

import java.io.IOException;
import java.util.Collections;

@RequiredArgsConstructor
public class AuthenticationFilter extends OncePerRequestFilter {
    private final JwtService jwtService;

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {
        // í† í° ê°€ì ¸ì˜¤ê¸°
        String jws = request.getHeader(HttpHeaders.AUTHORIZATION);  
        if (jws != null) {
            // í† í° ê²€ì¦ ë° ì‚¬ìš©ì ê°€ì ¸ì˜¤ê¸°
            String user = jwtService.getAuthUser(request);  // ì—¬ê¸° ì‘ì„± ë°©ì‹ì´ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤.
            // ì¸ì¦
            Authentication authentication = new UsernamePasswordAuthenticationToken(
                    user, null, Collections.emptyList()
            );
            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
        filterChain.doFilter(request, response);
    }
}
```
ì´ìƒì˜ ì½”ë“œì—ì„œ ì¤‘ìš”í•œ ì ì€ getAuthUser()ì˜ return íƒ€ì…ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì´ ë˜ê² ìŠµë‹ˆë‹¤. ì €í¬ê°€ ì§ì ‘ ì •ì˜í–ˆê¸° ë•Œë¬¸ì— í™•ì¸í•˜ì…”ì•¼ í•˜ëŠ”ë°, ì¼ë‹¨ String userë¼ëŠ” ë¶€ë¶„ì´ê² ì£ . User user ë­ ì´ëŸ°ê±° ì•„ë‹™ë‹ˆë‹¤.
ê·¸ë¦¬ê³  ì´ìƒì˜ ì½”ë“œë¥¼ ì‘ì„±í–ˆê¸° ë•Œë¬¸ì— SecurityConfigì— filter ê´€ë ¨ í´ë˜ìŠ¤ê°€ ì¶”ê°€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

```java
@Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.csrf(csrf -> csrf.disable())
                .sessionManagement(sessionManagement ->
                        sessionManagement.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
                .authorizeHttpRequests(authorizeHttpRequests ->
                        authorizeHttpRequests.requestMatchers(HttpMethod.POST, "/login").permitAll().anyRequest().authenticated())
                .addFilterBefore(authenticationFilter, UsernamePasswordAuthenticationFilter.class);
        return http.build();
    }
```
ì´ì „ì—ëŠ” `authorizeHttpRequests.requestMatchers(HttpMethod.POST, "/login").permitAll().anyRequest().authenticated());` ì—¬ê¸°ì„œ ë§ˆë¬´ë¦¬ ë˜ì—ˆì—ˆìŠµë‹ˆë‹¤. ì´ìƒì˜ ì½”ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `/login` endpointì— ëŒ€í•´ POST ìš”ì²­ì„ í—ˆìš©í•˜ê² ë‹¤ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë‚˜ë¨¸ì§€ ë¶€ë¶„ì— ëŒ€í•´ì„œ JWTê°€ ì¡´ì¬í•  ë•Œë§Œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê² ë‹¤ê³  ì¶”ê°€í•œ ë¶€ë¶„ì´ `.addFilterBefore(authenticationFilter, UsernamePasswordAuthenticationFilter.class);`ì— í•´ë‹¹í•©ë‹ˆë‹¤.

ì´ìƒê¹Œì§€ ì‘ì„±í–ˆì„ ë•Œ, ë¡œê·¸ì¸ ì´í›„ ê³¼ì •ê¹Œì§€ì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆê²Œ ë˜ëŠ”ë°, ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ í›„ì— POST /loginìœ¼ë¡œ ë¡œê·¸ì¸ì„ í•˜ê²Œ ë˜ë©´, Authorization í—¤ë”ì— JWTê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ ì²´í¬í•  ìˆ˜ ìˆê³ , body ë‚´ì— ìœ íš¨í•œ ì‚¬ìš©ìë¥¼ ì¶”ê°€í•´ì•¼í•˜ë©°, postmanì„ í†µí•´ ìë™ìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•ŠëŠ” ê²½ìš° Headersì— Content-Typeì„ application/jsonìœ¼ë¡œ ì„¤ì •í•´ë‘ì…”ì•¼ í•©ë‹ˆë‹¤.

ë¡œê·¸ì¸ì´ ì„±ê³µí–ˆë‹¤ë©´ ë¡œê·¸ì¸ì„ í†µí•´ ë°›ì€ JWT Authorization í—¤ë”ë¥¼ í†µí•´ ì „ì†¡í•˜ì—¬ ë‹¤ë¥¸ RESTful ì„œë¹„ìŠ¤ì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ ì‘ë‹µì—ì„œ ë‚˜ì˜¨ í† í°ì„ ë³µì‚¬í•©ë‹ˆë‹¤(Reponseì˜ Headerì—ì„œ Authorization ë¶€ë¶„ì˜ `Bearer `ë¥¼ ì œì™¸í•œ). ê·¸ë¦¬ê³  ì‘ë‹µì—ì„œ Authorization í—¤ë”ë¥¼ ì¶”ê°€í•œ ë‹¤ìŒì— GETìš”ì²­ì„ í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

ë³´ë‹ˆê¹Œ ì˜¤ë¥˜ ë‚˜ì…¨ë˜ ë¶„ë“¤ ì¤‘ì— ì½”ë“œ ìˆ˜ì •í•˜ê³  postman ìƒì—ì„œ ê¸°ì¡´ Requestë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ì˜¤ë¥˜ê°€ ì§€ì†ë˜ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì½”ë“œ ìˆ˜ì • í›„ì— New Request í†µí•´ì„œ ìƒˆë¡œ ë§Œë“¤ë©´ ê³§ì¥ ë°˜ì˜ë©ë‹ˆë‹¤.

# ì˜ˆì™¸ ì²˜ë¦¬í•˜ê¸°

í˜„ì¬ ìƒí™©ì—ì„œ postmanì—ì„œ /login POST ìš”ì²­ì„ ë‚ ë¦´ ë•Œ ìš°ë¦¬ê°€ CommandLineRunnerì— ì…ë ¥í•œ ë”ë¯¸ ë°ì´í„°ì™€ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¡œê·¸ì¸ì„ ì‹œë„í•  ê²½ìš°(username ì˜¤íƒ€ í˜¹ì€ passwordì—ì„œì˜ ì˜¤íƒ€), 403 ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì¶œë ¥ë©ë‹ˆë‹¤. ì¦‰ ì¶”ê°€ ì„¤ëª…ë„ ì—†ê³  ê·¸ëƒ¥ ê¸ˆì§€ëë‹¤ê³ ë§Œ ì•ˆë‚´ë¥¼ í•˜ê¸° ë•Œë¬¸ì— ê°œë°œì/ìœ ì € ì…ì¥ì—ì„œëŠ” ë­ê°€ ì˜ëª»ëëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ username/password ì˜¤íƒ€ì‹œì— 401 Unauthorized ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë„ìš°ëŠ” ë“±ì˜ ì„¸ì„¸í•œ ì»¤ìŠ¤í…€ì„ í•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.

Authentication ê´€ë ¨ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” AuthenticationEntryPoint ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. com.example.cardatabase(ì•ìœ¼ë¡œëŠ” ê·¸ëƒ¥ ë£¨íŠ¸ íŒ¨í‚¤ì§€ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤)ì— AuthEntryPoint í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , AuthenticationEntryPoint ì¸í„°í˜ì´ìŠ¤ë¥¼ _implement_ í•˜ì„¸ìš”. -> ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì‘ë‹µì„ 401ë¡œ ì„¤ì •í•˜ê³ , ì‘ë‹µ ë³¸ë¬¸ì— ì˜ˆì™¸ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ì—¬ ì•ˆë‚´í•  ìˆ˜ ìˆë„ë¡ í•  ì˜ˆì •ì…ë‹ˆë‹¤. ì´í•˜ì˜ ì½”ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.

```java
package com.example.cardatabase;

import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.http.MediaType;
import org.springframework.security.core.AuthenticationException;
import org.springframework.security.web.AuthenticationEntryPoint;

import java.io.IOException;
import java.io.PrintWriter;

public class AuthEntryPoint implements AuthenticationEntryPoint {
    @Override
    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {
        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
        response.setContentType(MediaType.APPLICATION_JSON_VALUE);
        PrintWriter writer = response.getWriter();
        writer.println("Error : " + authException.getMessage());
    }
}
```

Authenticationì´ ë¡œê·¸ì¸ ì‹œì— ìš”êµ¬ë˜ëŠ” username / passwordë¥¼ ì…ë ¥í•˜ì—¬ ì €í¬ ê¸°ì¤€ìœ¼ë¡œ app_userì´ë¼ëŠ” table ë‚´ì— í•´ë‹¹ username / passwordê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê³¼ì •ì´ì—ˆìŠµë‹ˆë‹¤.

SecurityConfig ê´€ë ¨ ì„¤ì •ë„ ìˆ˜ì •ì„ í•´ì¤˜ì•¼ë§Œ í•©ë‹ˆë‹¤.

ë‹¤ ìˆ˜ì •í•˜ê³  ë‚˜ë©´ POST /loginì—ì„œ username / password ì¤‘ì— í•˜ë‚˜ê°€ dummy dataì™€ ë‹¤ë¥´ë‹¤ë©´ ì˜ˆì „ì—ëŠ” 403ì´ ë–´ìœ¼ë‚˜ ì´ì œëŠ” 401ì´ ëœ¨ë©´ì„œ ìš°ë¦¬ê°€ ì„¤ì •í•œ messageë¥¼ ì‘ë‹µ ë°›ì€ JSON ë‚´ìš©ì— ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.

# CORS filter ì„¤ì •
# AppUser entity í´ë˜ìŠ¤ì— roleì´ ìˆê³  "USER", "ADMIN"ìœ¼ë¡œ ë‚˜ëˆ„ì—ˆëŠ”ë°, ê·¸ì— ë”°ë¥¸ ê¶Œí•œ ë¶„ë¦¬