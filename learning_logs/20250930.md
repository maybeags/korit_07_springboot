# ì…ì‹¤ ì²´í¬ í•´ì£¼ì„¸ìš” !! ğŸ’Œ

# Spring Security ì¶”ê°€ ì •ë¦¬
## ì •ì˜
- Spring ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ(Authentication / Authorization)ì„ ìœ„í•œ í‘œì¤€ í”„ë ˆì„ì›Œí¬. ì„œë¸”ë¦¿ í•„í„°(Servlet Filter) ì²´ì¸ì„ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©°, ì›¹ ìš”ì²­ì— ëŒ€í•œ ë³´ì•ˆì„ ì²´ê³„ì ìœ¼ë¡œ ì²˜ë¦¬í•¨. ë‹¨ìˆœí•œ ë¡œê·¸ì¸ ê¸°ëŠ¥ ë¿ë§Œ ì•„ë‹ˆë¼, CSRF ê³µê²© ë°©ì§€, ì„¸ì…˜ ê´€ë¦¬, ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ë“± í¬ê´„ì ì¸ ë³´ì•ˆ ê¸°ëŠ¥ì„ ì œê³µ.
## íŠ¹ì§•
1. í¬ê´„ì  ë³´ì•ˆ ê¸°ëŠ¥ : ì¸ì¦(Authentication) / ì¸ê°€(Authorization) ë¿ ì•„ë‹ˆë¼ ì¼ë°˜ì ì¸ ì›¹ ë³´ì•ˆ ìœ„í˜‘ìœ¼ë¡œë¶€í„° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³´í˜¸.
2. ìœ ì—°í•œ ì„¤ì • : Java ê¸°ë°˜ì˜ ì„¤ì •ì„ í†µí•´ ìœ ì—°í•˜ê²Œ ë³´ì•ˆ ì •ì±…ì„ ì„¤ì •í•  ìˆ˜ ìˆìŒ(ìš°ë¦¬ê°€ í•´ì•¼í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤).
3. ì„œë¸”ë¦¿ í•„í„° ê¸°ë°˜ : ìš”ì²­ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì— ë„ë‹¬í•˜ê¸° ì „ì— ì—¬ëŸ¬ ë³´ì•ˆ í•„í„°ë¥¼ ê±°ì¹˜ê²Œ í•˜ì—¬ ì„ ì œì ì¸ ë³´ì•ˆ ê²€ì‚¬ë¥¼ ìˆ˜í–‰.
4. SpringBootì™€ì˜ í†µí•© : `spring-boot-starter-security`ì˜ì¡´ì„±ë§Œ ì¶”ê°€í•˜ë©´ ê¸°ë³¸ì ì¸ ë³´ì•ˆ ê¸°ëŠ¥ì´ ìë™ ì„¤ì •ë˜ì–´ ë¹ ë¥´ê²Œ ì ìš©ê°€ëŠ¥(default ë¡œê·¸ì¸ í˜ì´ì§€ê°€ ìƒê²¼ê³ , passwordê°€ ì½˜ì†”ì— ì°í˜”ìŠµë‹ˆë‹¤).
## SecurityConfig 
- Spring Securityì˜ ë³´ì•ˆ êµ¬ì„±(Config)ì„ ë‹´ë‹¹í•˜ëŠ” Java ì„¤ì • í´ë˜ìŠ¤ë¡œ, í•´ë‹¹ í´ë˜ìŠ¤ì—ëŠ” `@Configuration, @EnableWebSecurity` ì• ë„ˆí…Œì´ì…˜ì„ ì¶”ê°€í•˜ì—¬ Spring Securityì˜ ì›¹ ë³´ì•ˆ ì„¤ì •ì„ í™œì„±í™”í•˜ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ê³¼ê±°ì—ëŠ” `WebSecurityConfigurerAdapter`ë¥¼ ìƒì† ë°›ì•„ì„œ configure() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í–ˆì—ˆì§€ë§Œ, SpringBoot 3.x ë²„ì „ë¶€í„°ëŠ” SecurityFilterChain ë¹ˆ(bean)ì„ ë“±ë¡í•˜ëŠ” ë°©ì‹ì´ ê¶Œì¥ë©ë‹ˆë‹¤. í˜„ì¬ì˜ ë°©ì‹ì€ ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ì˜ êµ¬ì„±ìœ¼ë¡œ, ë”ìš± ëª¨ë“ˆí™”ë˜ê³  ìœ ì—°í•œ ë³´ì•ˆ êµ¬ì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### SecurityConfigì˜ í•µì‹¬ ì—­í• 
1. HTTP ìš”ì²­ì— ëŒ€í•œ ì ‘ê·¼ ì œì–´ : íŠ¹ì • URL íŒ¨í„´ì— ëŒ€í•´ ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ì„ í—ˆìš©í•˜ê±°ë‚˜, íŠ¹ì • ê¶Œí•œ(Role)ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì • ê°€ëŠ¥.
2. ì¸ì¦ ë°©ì‹ ì„¤ì • : í¼ ë¡œê·¸ì¸(Form Login), HTTP Basic ì¸ì¦, OAuth2 ë¡œê·¸ì¸ ë“± ë‹¤ì–‘í•œ ì¸ì¦ ë°©ì‹ì„ ì„¤ì •í•˜ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥.
3. ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ : ë¡œê·¸ì•„ì›ƒ URL ë° ë¡œê·¸ì•„ì›ƒ ì„±ê³µ í›„ ì²˜ë¦¬ ë¡œì§ì„ ì •ì˜.
4. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” : `PasswordEncoder`ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”í•˜ê³  ê²€ì¦í•˜ëŠ” ë°©ì‹ì„ ì§€ì •.
5. CSRF, CORS ì„¤ì • : CSRF ë³´í˜¸ ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê±°ë‚˜ ë¹„í™œì„±í™”í•˜ê³ , CORS ì •ì±…ì„ êµ¬ì„±í•©ë‹ˆë‹¤.

### SecurityConfig ì½”ë“œ ì˜ˆì‹œ
```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
  // ë¹„ë°€ ë²ˆí˜¸ ë“±ë¡ì„ ìœ„í•œ PasswordEncoder ë¹ˆì„ ë“±ë¡
  @Bean
  public PasswordEncoder passwordEncoder() {
    return new BCyptPasswordEncoder();
  }

  // Spring Securityì˜ filterChainì„ ì‘ì„±í• ê²ë‹ˆë‹¤.
  @Bean
  public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
      // 1. ì¸ê°€(Authorization) êµ¬ì„±
        .authorizeHttpRequests(authorize -> authorize
          .requestMatchers("/users/**").authenticated() // /user/** ê²½ë¡œëŠ” ì¸ì¦ëœ userë§Œ ê°€ëŠ¥
          .requestMatchers("/manager/**").hasAnyRole("ADMIN", "MANAGER") // /manager/** ê²½ë¡œëŠ” roleì´ ADMINì´ê±°ë‚˜ MANAGERì¸ userë§Œ ê°€ëŠ¥
          .requestMatchers("/admin/**").hasRole("ADMIN") // /admin/** ê²½ë¡œëŠ” roleì´ ADMINì¸ userë§Œ ê°€ëŠ¥
          .anyRequest().permitAll() // ë‚˜ë¨¸ì§€ ê²½ë¡œì— ëŒ€í•œ ìš”ì²­ë“¤ì€ ì ‘ê·¼ì„ í—ˆìš©í•¨.
        )
        // 2. í¼ ë¡œê·¸ì¸(Form Login) êµ¬ì„±
        .formLogin(form -> form
          .loginPage("/login")    // ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€ì˜ URL ì§€ì •
          .loginProcessingUrl("/loginProc") // ë¡œê·¸ì¸ ì²˜ë¦¬ URL
          .defaultSucessUrl("/")  // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì´ë™í•  default URL
          .permitAll()            // ë¡œê·¸ì¸ í˜ì´ì§€ëŠ” ëª¨ë“  ì‚¬ìš©ìê°€ ì ‘ê·¼ ê°€ëŠ¥
        )
        // 3. ë¡œê·¸ì•„ì›ƒ ì„¤ì •
        .logout(logout -> logout
          .logoutUrl("/logout")   // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ URL
          .logoutSuccessUrl("/")  // ë¡œê·¸ì•„ì›ƒ ì„±ê³µ ì‹œ ì´ë™í•  URL
          .invalidateHttpSession(true)    // ì„¸ì…˜ ë¬´íš¨í™”
          .deleteCookies("JSESSIONID")         // ì¿ í‚¤ ì‚­ì œ
        )
        // 4. CSRF ë³´í˜¸ ë¹„í™œì„±í™”(API ì„œë²„ì˜ ê²½ìš°)
        .csrf(csrf -> csrf.disable());
  }
}
```
- ì´ìƒì˜ ì½”ë“œì˜ ìƒì„¸ ì„¤ëª…
  1. authorizeHttpRequests : HTTP ìš”ì²­ì— ëŒ€í•œ ì¸ê°€ ê·œì¹™ì„ êµ¬ì„±.
    - requestMatchers() : íŠ¹ì • URL íŒ¨í„´ì„ ì§€ì •
    - authenticated() : ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ í—ˆìš©
    - hasAnyRole(), hasRole() : íŠ¹ì • ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼ì„ í—ˆìš©. Spring Securityì—ì„œ ì—­í• (Role)ì€ ê¸°ë³¸ì ìœ¼ë¡œ "ROLE_" ì ‘ë‘ì‚¬ê°€ ë¶™ì–´ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.(ì˜ˆì‹œ : hasRole("ADMIN")ì€ "ROLE_ADMIN" ì—­í• ì„ í™•ì¸í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤)
    - permitAll() : ëª¨ë“  ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ í—ˆìš©.
    - anyRequest() : ìœ„ì—ì„œ ì„¤ì •í•œ ê·œì¹™ ì™¸ì˜ ëª¨ë“  ìš”ì²­ì„ ì˜ë¯¸í•¨. _ê·¸ë˜ì„œ ì¸ê°€ ê·œì¹™ì˜ ê²½ìš° êµ¬ì²´ì ì¸ ê²½ë¡œë¥¼ ë¨¼ì € êµ¬ì„±í•˜ê³ , í¬ê´„ì ì¸ ê²½ë¡œëŠ” ë‚˜ì¤‘ì— êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤._ 
  2. formLogin : í¼ ê¸°ë°˜ ë¡œê·¸ì¸ì„ ì„¤ì •
    - loginPage() : ê¸°ë³¸ ì œê³µë˜ëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ ëŒ€ì‹  ì‚¬ìš©í•  ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€ì˜ ê²½ë¡œë¥¼ ì§€ì •.
    - loginProcessingUrl() : ë¡œê·¸ì¸ í¼ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  URLì„ ì§€ì •. ì´ URLì— ëŒ€í•œ POST ìš”ì²­ì„ Spring Securityê°€ ê°€ë¡œì±„ì„œ ì¸ì¦ì„ ì²˜ë¦¬í•¨.
    - defaultSuccessUrl() : ë¡œê·¸ì¸ ì„±ê³µ í›„ ì‚¬ìš©ìë¥¼ ë¦¬ë””ë ‰ì…˜í•  ê¸°ë³¸ í˜ì´ì§€ ì§€ì •.
  3. logout : ë¡œê·¸ì•„ì›ƒ ê´€ë ¨ ì„¤ì •.
    - logouturl() : ë¡œê·¸ì•„ì›ƒì„ ì²˜ë¦¬í•  URLì„ ì§€ì •.
    - logoutSuccessUrl() : ë¡œê·¸ì•„ì›ƒ ì„±ê³µ í›„ ë¦¬ë””ë ‰ì…˜ ë  í˜ì´ì§€ë¥¼ ì§€ì •.
    - invalidateHttpSession(true) : ë¡œê·¸ì•„ì›ƒ ì‹œ HTTP ì„¸ì…˜ì„ ë¬´íš¨í™”.
    - deleteCookies("JSESSIONID") : ë¡œê·¸ì•„ì›ƒ ì‹œ ì§€ì •ëœ ì¿ í‚¤ë¥¼ ì‚­ì œ.
  4. csrf(csrf -> csrf.disable()) : CSRF ë³´í˜¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”. ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ì´ ì•„ë‹ˆë¼ _JWTì™€ ê°™ì€ í† í° ê¸°ë°˜ ì¸ì¦ì„ ì‚¬ìš©í•˜ëŠ” API ì„œë²„ì˜ ê²½ìš° ì¼ë°˜ì ìœ¼ë¡œ ë¹„í™œì„±í™”_


Java ê´€ë ¨ visual studio code Extension

Code Runner -> Java í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ë ¤ë©´ í•„ìš”í•©ë‹ˆë‹¤.
Debugger for Java
Extension Pack for Java